#+TITLE: The REST API
#+AUTHOR: VLEAD
#+DATE: [2016-07-26 Tue]
#+SETUPFILE: ../../org-templates/level-2.org
#+TAGS: boilerplate(b)
#+EXCLUDE_TAGS: boilerplate
#+OPTIONS: ^:nil

* Introduction 
  This document illustrates building of the REST API.
  
* REST
** API Design
*** Get college registration form
  - URL :: /get_college_reg_form
  - Method :: GET

  - URL Params ::  None
       
  - Success Response ::
    + Code: 200

    + Content :: 
      #+BEGIN_EXAMPLE
      A web page with college cloud registration form is shown.
      #+END_EXAMPLE

  - Error Response ::
    + Code: 401 UNAUTHORIZED

    + Content: { error : "Not Authorized" }

    OR

    + Code: 400 Bad Request

    + Content: { error : "Malformed arguments" }

    OR

    + Code: 500

    + Content: { error : Exception String}


  - Example ::
    #+BEGIN_EXAMPLE
    http://localhost:5000/get_college_reg_form
    #+END_EXAMPLE
*** Store college registration form data to local =<file>.json= file

   - URL :: /store_college_reg_form_data

   - Method :: POST

   - Data Params ::
     {
      'MAC_ID' : {
		   'college_details' : {
           		   'name': '<value>',
                           'location' : '<value>'
	 	    }
		 }
     }

   - Success Response ::
     + Code: 200

     + Content:
       #+BEGIN_EXAMPLE
       {
       "status" : "Successfully saved records"
       }
       
       #+END_EXAMPLE
   
  - Error Response ::
    + Code: 401 UNAUTHORIZED

    + Content: { error : "Not Authorized error: not Authorized to perform this action" }

    OR

    + Code: 400 Bad Request

    + Content: { error : "Malformed arguments" }

    OR

    + Code: 500

    + Content: { error : Exception String}

  - Example ::
    #+BEGIN_EXAMPLE
    http://localhost:5000/add_user
    #+END_EXAMPLE
*** Get college cloud ID
  - URL :: /get_college_cloud_id
  - Method :: GET

  - URL Params ::  None
       
  - Success Response ::
    + Code: 200

    + Content :: 
      #+BEGIN_EXAMPLE
      {
        'college_cloud_id' : '<value>'
      }
      #+END_EXAMPLE

  - Error Response ::
    + Code: 401 UNAUTHORIZED

    + Content: { error : "Not Authorized" }

    OR

    + Code: 400 Bad Request

    + Content: { error : "Malformed arguments" }

    OR

    + Code: 500

    + Content: { error : Exception String}


  - Example ::
    #+BEGIN_EXAMPLE
    http://localhost:5000/get_college_cloud_id
	      #+END_EXAMPLE

*** Dump college cloud data to ELK

   - URL :: /save_cc_data_to_elk

   - Method :: POST

   - Data Params ::
     {
      'MAC_ID' : '<value>',
      'college_details' : {
           	   'name': '<value>',
                   'location' : '<value>'
	 	   }
     }

   - Success Response ::
     + Code: 200

     + Content:
       #+BEGIN_EXAMPLE
       {
       "status" : "Successfully saved records"
       }
       
       #+END_EXAMPLE
   
  - Error Response ::
    + Code: 401 UNAUTHORIZED

    + Content: { error : "Not Authorized error: not Authorized to perform this action" }

    OR

    + Code: 400 Bad Request

    + Content: { error : "Malformed arguments" }

    OR

    + Code: 500

    + Content: { error : Exception String}

  - Example ::
    #+BEGIN_EXAMPLE
    http://localhost:5000/add_user
    #+END_EXAMPLE
*** Dump feedback to ELK stack
  :PROPERTIES:
  :CUSTOM_ID: dump_feedback
  :END:    

   - URL :: /dump_feedback_to_elk

   - Method :: POST

   - Payload ::
     {
      'tag_name': 'college_name',
      'mac_id' : 'value',
      'feedbacks': ['list_of_feedbacks'],
      'server_name' : 'http://<elastic-search-domain>',
      'key': 'key'
     }

   - Success Response ::
     + Code: 200
     + Content:
       {
         status: "successfully added feedback records"
       }

   - Error Response ::
     + Code: 401 UNAUTHORIZED

     + Content: { error : "Wrong Key configured" }

     OR

     + Code: 400 Bad Request

     + Content: { error : "some of the parameters are not part of the
       request" }

*** Dump usage to ELK stack
  :PROPERTIES:
  :CUSTOM_ID: dump_usage
  :END:    

   - URL :: /dump_usage_to_elk

   - Method :: POST

   - Payload ::
     {
      'tag_name': 'college_name',
      'mac_id' : 'value',
      'usages': ['list_of_usages'],
      'server_name' : 'http://<elastic-search-domain>',
      'key': 'key'
     }

   - Success Response ::
     + Code: 200
     + Content:
       {
         status: "successfully added usage records"
       }

   - Error Response ::
     + Code: 401 UNAUTHORIZED

     + Content: { error : "Wrong Key configured" }

     OR

     + Code: 400 Bad Request

     + Content: { error : "some of the parameters are not part of the
       request" }

